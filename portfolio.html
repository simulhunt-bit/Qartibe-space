<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Portfolio | Qartibe Space</title>
    <meta name="description" content="Portfolio case studies from Qartibe Space." />
    <meta name="robots" content="index, follow, max-image-preview:large" />
    <meta name="author" content="Qartibe Space" />
    <meta name="theme-color" content="#0f2540" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Portfolio | Qartibe Space" />
    <meta property="og:description" content="Portfolio case studies from Qartibe Space." />
    <meta property="og:url" content="https://qartibe.space/portfolio" />
    <meta property="og:image" content="https://qartibe.space/logo.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Portfolio | Qartibe Space" />
    <meta name="twitter:description" content="Portfolio case studies from Qartibe Space." />
    <meta name="twitter:image" content="https://qartibe.space/logo.png" />
    <link rel="canonical" href="https://qartibe.space/portfolio" />
    <link rel="icon" href="favicon.png" type="image/png" />
    <link rel="preload" as="image" href="logo.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Sora:wght@500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles/portfolio.css" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "Portfolio",
        "url": "https://qartibe.space/portfolio",
        "description": "Portfolio case studies from Qartibe Space."
      }
    </script>
  </head>
  <body data-page="portfolio">
    <header class="nav">
      <div class="container nav-inner">
        <a class="brand-link" href="/"><img src="logo.png" alt="Qartibe Space" width="28" height="28" style="border-radius:50%;background:#eaf2ff" /><span>Qartibe Space</span></a>
        <nav class="nav-links" id="siteMenu">
          <a href="/">Home</a>
          <a href="/portfolio">Portfolio</a>
          <a href="/blog">Blog</a>
          <a href="/services">Services</a>
          <a class="nav-cta-link" href="/#contact">Contact</a>
        </nav>
        <div class="nav-actions"></div>
      </div>
    </header>
    <nav class="breadcrumb-wrap" aria-label="Breadcrumb">
      <div class="container">
        <ol id="breadcrumbTrail" class="breadcrumb-list"></ol>
      </div>
    </nav>

    <main class="container section">
      <h1 id="pageTitle">Latest Portfolio Projects</h1>
      <p class="muted" id="pageNote">Case studies from paid growth, CRO, and SEO execution.</p>
      <section id="projectList" class="grid grid-2"><article class="card"><p class="muted">Loading projects...</p></article></section>
    </main>

    <footer>
      <div class="container">
        &copy; 2026 Qartibe Space. All rights reserved.
        <a
          href="https://www.facebook.com/qartibe/"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Official Facebook page"
          style="display:inline-flex;align-items:center;gap:6px;margin-left:12px;color:inherit;text-decoration:none;"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" aria-hidden="true">
            <path
              fill="currentColor"
              d="M22 12a10 10 0 1 0-11.56 9.88v-6.99H7.9V12h2.54V9.8c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.23.2 2.23.2v2.46h-1.26c-1.24 0-1.62.77-1.62 1.55V12h2.77l-.44 2.89h-2.33v6.99A10 10 0 0 0 22 12Z"
            />
          </svg>
          <span>Official Facebook</span>
        </a>
      </div>
    </footer>

    <script src="scripts/header-auth.js" defer></script>
    <script src="scripts/site-nav.js" defer></script>
    <script src="scripts/access-gates.js" defer></script>
    <script src="scripts/content-loader.js"></script>
    <script>
      const canonicalTag = document.querySelector('link[rel="canonical"]');
      const ogTitleTag = document.querySelector('meta[property="og:title"]');
      const ogDescriptionTag = document.querySelector('meta[property="og:description"]');
      const ogUrlTag = document.querySelector('meta[property="og:url"]');
      const twitterTitleTag = document.querySelector('meta[name="twitter:title"]');
      const twitterDescriptionTag = document.querySelector('meta[name="twitter:description"]');

      const updateSeoForProject = (project) => {
        const detailUrl = `${window.location.origin}/portfolio/${encodeURIComponent(project.slug)}`;
        const title = `${project.title_en} | Qartibe Space Portfolio`;
        const description = String(project.summary_en || "Portfolio case study from Qartibe Space.");
        document.title = title;
        if (canonicalTag) canonicalTag.href = detailUrl;
        if (ogTitleTag) ogTitleTag.content = title;
        if (ogDescriptionTag) ogDescriptionTag.content = description;
        if (ogUrlTag) ogUrlTag.content = detailUrl;
        if (twitterTitleTag) twitterTitleTag.content = title;
        if (twitterDescriptionTag) twitterDescriptionTag.content = description;
      };

      const getProjectKey = () => {
        const cleanPath = window.location.pathname.replace(/\/+$/, "");
        const match = cleanPath.match(/\/portfolio\/([^/]+)$/i);
        if (match && match[1]) return decodeURIComponent(match[1]).trim().toLowerCase();
        const params = new URLSearchParams(window.location.search);
        return String(params.get("project") || "").trim().toLowerCase();
      };

      const escapeHtml = (value) =>
        String(value || "").replace(/[&<>"']/g, (char) => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[char]));

      const toSafeHref = (value) => {
        if (typeof value !== "string" || !value.trim()) return "";
        const href = value.trim();
        if (/^(https?:|mailto:|tel:)/i.test(href)) return href;
        if (href.startsWith("/portfolio/") || href === "/portfolio" || href.startsWith("#")) return href;
        return "";
      };

      const renderMarks = (textNode) => {
        let value = escapeHtml(textNode?.value || "");
        const marks = Array.isArray(textNode?.marks) ? textNode.marks : [];
        marks.forEach((mark) => {
          switch (mark?.type) {
            case "bold":
              value = `<strong>${value}</strong>`;
              break;
            case "italic":
              value = `<em>${value}</em>`;
              break;
            case "underline":
              value = `<u>${value}</u>`;
              break;
            case "code":
              value = `<code>${value}</code>`;
              break;
            default:
              break;
          }
        });
        return value;
      };

      const renderChildren = (node) =>
        (Array.isArray(node?.content) ? node.content : []).map((child) => renderRichNode(child)).join("");

      const renderRichNode = (node) => {
        if (!node || typeof node !== "object") return "";
        if (node.nodeType === "text") return renderMarks(node);
        const children = renderChildren(node);
        switch (node.nodeType) {
          case "document":
            return children;
          case "paragraph":
            return `<p>${children}</p>`;
          case "heading-1":
            return `<h1>${children}</h1>`;
          case "heading-2":
            return `<h2>${children}</h2>`;
          case "heading-3":
            return `<h3>${children}</h3>`;
          case "heading-4":
            return `<h4>${children}</h4>`;
          case "heading-5":
            return `<h5>${children}</h5>`;
          case "heading-6":
            return `<h6>${children}</h6>`;
          case "unordered-list":
            return `<ul>${children}</ul>`;
          case "ordered-list":
            return `<ol>${children}</ol>`;
          case "list-item":
            return `<li>${children}</li>`;
          case "blockquote":
            return `<blockquote>${children}</blockquote>`;
          case "hr":
            return "<hr />";
          case "table":
            return `<table>${children}</table>`;
          case "table-row":
            return `<tr>${children}</tr>`;
          case "table-header-cell":
            return `<th>${children}</th>`;
          case "table-cell":
            return `<td>${children}</td>`;
          case "hyperlink": {
            const href = toSafeHref(node?.data?.uri || "");
            if (!href) return children;
            if (/^(https?:|mailto:|tel:)/i.test(href)) {
              return `<a href="${escapeHtml(href)}" target="_blank" rel="noopener noreferrer">${children}</a>`;
            }
            return `<a href="${escapeHtml(href)}">${children}</a>`;
          }
          case "embedded-asset-block": {
            const fileUrl = node?.data?.target?.fields?.file?.url;
            const title = node?.data?.target?.fields?.title || "Embedded image";
            if (typeof fileUrl !== "string" || !fileUrl.trim()) return "";
            const src = fileUrl.startsWith("http") ? fileUrl : `https:${fileUrl}`;
            return `<figure><img src="${escapeHtml(src)}" alt="${escapeHtml(title)}" loading="lazy" decoding="async" /></figure>`;
          }
          default:
            return children;
        }
      };

      const renderDescription = (project) => {
        const richDescription = project?.richDescription;
        if (richDescription && Array.isArray(richDescription.content) && richDescription.content.length > 0) {
          return `<div class="project-content">${renderRichNode(richDescription)}</div>`;
        }
        const fallback = String(project.summary_en || "");
        return fallback ? `<div class="project-content"><p>${escapeHtml(fallback)}</p></div>` : "";
      };

      const renderList = (projects) => {
        const list = document.getElementById("projectList");
        if (!projects.length) {
          list.innerHTML = '<article class="card"><p class="muted">No projects yet.</p></article>';
          return;
        }
        list.innerHTML = projects
          .map((project) => {
            const tags = Array.isArray(project.tags_en) ? project.tags_en : [];
            const duration = String(project.duration || "").trim();
            const actionsTaken = String(project.actionsTaken || "").trim();
            const results = String(project.results || project.result_en || "").trim();
            return `
              <article class="card">
                <h3>${escapeHtml(project.title_en)}</h3>
                <p class="muted">${escapeHtml(project.summary_en || "")}</p>
                <div class="tags">${tags.map((tag) => `<span class="tag">${escapeHtml(tag)}</span>`).join("")}</div>
                <div class="meta-list">
                  ${duration ? `<p class="meta-item"><strong>Duration:</strong> ${escapeHtml(duration)}</p>` : ""}
                  ${actionsTaken ? `<p class="meta-item"><strong>Actions:</strong> ${escapeHtml(actionsTaken)}</p>` : ""}
                  ${results ? `<p class="meta-item"><strong>Results:</strong> ${escapeHtml(results)}</p>` : ""}
                </div>
                <a class="btn btn-outline" href="/portfolio/${encodeURIComponent(project.slug)}">View details</a>
              </article>
            `;
          })
          .join("");
      };

      const renderSingle = (project) => {
        const list = document.getElementById("projectList");
        const pageTitle = document.getElementById("pageTitle");
        const pageNote = document.getElementById("pageNote");
        const tags = Array.isArray(project.tags_en) ? project.tags_en : [];
        const duration = String(project.duration || "").trim();
        const actionsTaken = String(project.actionsTaken || "").trim();
        const results = String(project.results || project.result_en || "").trim();
        const descriptionHtml = renderDescription(project);

        pageTitle.textContent = project.title_en;
        pageNote.textContent = project.summary_en || "";
        list.classList.remove("grid-2");
        updateSeoForProject(project);
        list.innerHTML = `
          <article class="card">
            <h2>${escapeHtml(project.title_en)}</h2>
            ${descriptionHtml}
            <div class="tags">${tags.map((tag) => `<span class="tag">${escapeHtml(tag)}</span>`).join("")}</div>
            <div class="meta-list">
              ${duration ? `<p class="meta-item"><strong>Duration:</strong> ${escapeHtml(duration)}</p>` : ""}
              ${actionsTaken ? `<p class="meta-item"><strong>Actions taken:</strong> ${escapeHtml(actionsTaken)}</p>` : ""}
              ${results ? `<p class="meta-item"><strong>Results:</strong> ${escapeHtml(results)}</p>` : ""}
            </div>
            <a class="btn btn-outline" href="/portfolio">Back to all projects</a>
          </article>
        `;
      };

      (async () => {
        try {
          const projects = await window.QartibeContentLoader.getPortfolioProjects();
          const key = getProjectKey();
          if (!key) {
            renderList(projects);
            return;
          }
          const project = projects.find((item) => [item.slug, item.id].map((x) => String(x || "").toLowerCase()).includes(key));
          if (!project) {
            document.getElementById("pageTitle").textContent = "Project not found";
            document.getElementById("pageNote").textContent = "The requested project does not exist.";
            document.getElementById("projectList").innerHTML = '<article class="card"><a class="btn btn-outline" href="/portfolio">Back to all projects</a></article>';
            return;
          }
          if (window.location.pathname !== `/portfolio/${project.slug}`) {
            history.replaceState({}, "", `/portfolio/${encodeURIComponent(project.slug)}${window.location.hash}`);
          }
          renderSingle(project);
        } catch {
          document.getElementById("projectList").innerHTML = '<article class="card"><p class="muted">Unable to load projects.</p></article>';
        }
      })();
    </script>
  </body>
</html>






